import{unified as t}from"unified";import e from"remark-parse";import n from"remark-gfm";import r from"@sindresorhus/slugify";import i from"remark-stringify";import o from"strip-final-newline";import{isMatch as s,parse as l}from"date-fns";import{zonedTimeToUtc as a,formatInTimeZone as c}from"date-fns-tz/esm";const m=["yyyy-MM-dd","dd/MM/yyyy","dd/MM/yy","dd-MM-yyyy","dd-MM-yy","dd.MM.yyyy","dd.MM.yy"],f=["HH:mm","HH.mm","hh:mm a","hh:mm A"],d=function(t){const e=m.map(e=>s(t,e));return e.indexOf(!0)>-1?a(l(t,m[e.indexOf(!0)],new Date),"UTC").toJSON().split("T")[0]:null},p=function(t){const e=f.map(e=>s(t,e));if(e.indexOf(!0)>-1){const n=a(l(t,f[e.indexOf(!0)],new Date),"UTC");return c(n,"UTC","HH:mm")}return null},u=function(t){let e=!1;const n={hours:0,minutes:0},r=new RegExp(/([0-9]+)h([0-9]+)m/),i=new RegExp(/([0-9]+)h/);if(t.match(r)){e=!0;const[,i,o]=t.match(r);n.hours=parseInt(i),n.minutes=parseInt(o)}else if(t.match(i)){e=!0;const[,r]=t.match(i);n.hours=parseInt(r),n.minutes=0}return e?n:null},h=function t(e){return e.children.map(n=>{const r={};return"list"===n.type?t(e):"listItem"===n.type?(r.checked=n.checked,n.children.map(t=>{if("paragraph"===t.type)return r.text=t.children.map(t=>"link"===t.type?t.children[0].value:t.value).filter(t=>!!t).join(""),r}).filter(t=>!!t)):void 0}).filter(t=>!!t)};async function y(s){const l=await t().use(e).use(n).parse(s);if(!l)return[];const a={};let c=null;for(const e of l.children){const s=await t().use(n).use(i).stringify(e),l=o(s);if("heading"===e.type&&3===e.depth)c=r(e.children[0].value),a[c]={title:e.children[0].value,content:[]};else if("paragraph"===e.type&&c){const t=a[c],e=d(l),n=p(l),r=u(l);e&&(t.date=e),n&&(t.time=n),r&&(t.duration=r),t.content.push(l)}else if("list"===e.type){const t=a[c];t.text=l,t.list=h(e).flat()}else if("html"===e.type)a[c].content.push(e.html);else if("code"===e.type){const t=a[c];t.lang=e.lang,t.text=l}else"heading"===e.type&&e.depth>3?a[c].content.push(e.children[0].value):(console.log("unhandled token type"),console.log(e))}for(const t in a){const e=a[t],n=e.content.filter(Boolean);n&&n.length>0&&(1===n.length&&(e.text=n[0]),e.text=n.join("\n\n")),e.content=n}return a}export{y as default};
//# sourceMappingURL=parse.modern.js.map
